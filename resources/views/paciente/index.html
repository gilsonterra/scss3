{% extends "base.html" %} {% block content %}
<div id="paciente-view"></div>
{% endblock %} {% block js %}
<script src="{{ base_url }}/tags/paciente/view.html"></script>
<script src="{{ base_url }}/tags/paciente/view-identificacao.html"></script>
<script src="{{ base_url }}/tags/paciente/view-acompanhamentos.html"></script>
<script src="{{ base_url }}/tags/paciente/view-entrevistas.html"></script>
<script type="text/javascript">
    window.onload = function () {
        APP.load.css(BASE_URL + '/css/sweetalert2.min.css');
    };

    var codigo_paciente = '{{ codigo_paciente }}';
    if (codigo_paciente) {
        var data = {};
        data.joins = [
            'endereco',
            'enderecoContato',
            'acompanhamentos.local',
            'acompanhamentos.profissional',
            'acompanhamentos.acompanhamentoItem.categoria',
            'entrevistas.local',
            'entrevistas.profissional'
        ];
        APP.ajaxGetRequest(BASE_URL + '/session',
            function (jsonSession) {
                APP.ajaxPostRequest(BASE_URL + '/paciente/find/' + codigo_paciente, JSON.stringify(data),
                    function (json) {
                        riot.mount('#paciente-view', 'paciente-view', {
                            'dados': json,
                            'usuarioSessao': jsonSession.usuario_sessao
                        });
                    }
                );
            }
        );

    }
</script>
{% endblock %}